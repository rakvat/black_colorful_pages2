{% extends 'base.html' %}

{% block content %}
<h1>Organize</h1>
<div class="w3-row controls">
  <form class="controls-form" action="{{url_for('organize')}}">
    <div class="control-item">
      <label for="group">{{L['list']['group_filter']}}:&nbsp;</label>
      <input
          id="group" class="w3-input" type="checkbox" name="group"
          {% if request.args.get('group') %}checked{% endif %}
      />
    </div>
    <div class="control-item">
      <label for="location">{{L['list']['location_filter']}}:&nbsp;</label>
      <input
          id="location" class="w3-input" type="checkbox" name="location"
          {% if request.args.get('location') %}checked{% endif %}
      />
    </div>
    <div class="control-item">
      <label for="media">{{L['list']['media_filter']}}:&nbsp;</label>
      <input
          id="media" class="w3-input" type="checkbox" name="media"
          {% if request.args.get('media') %}checked{% endif %}
      />
    </div>
    <div class="control-item">
      <input
          id="query" class="w3-input" type="text" placeholder="{{L['list']['search_query_filter']}}" name="query"
          value="{{request.args.get('query') or ''}}"
      />
    </div>
    <button class="w3-button w3-black" type="submit">{{L['list']['search_button']}}</button>
  </form>
  <a class="w3-button w3-black none" href="{{url_for('organize')}}">{{L['list']['reset_search_button']}}</a>
  <div class="control-item count"><span>{{contacts|length}} {{L['list']['num_structures_label']}}</span></div>
  <br/>
  <div>
    <h4>Hints</h4>
    <ul>
      <li>The short description is only used in collapsed state.</li>
      <li>Description should not repeat short description.</li>
      <li>Resources is everything the contact provides from food, books, advice, media, locations to healthcare, information, and solidarity.</li>
      <li>The base address is only shown in collapsed state. It should be the name of the rough neighborhood or a domain for structures without physical location.</li>
      <li>Contact can contain all forms of contact forms the struture is ok with. @ in emails will be automatically replaced</li>
      <li>Use \n to create linebreaks in description, resources, addresses, and contact.</li>
      <li>Latitude, Longitude has to be in the format 12.3456;12.3456</li>
      <li>The image is a filename. The file has to be uploaded by the admin.</li>
      <li>The email field is only used for internal purposes. Add it to the contact field if it should be publicly visible</li>
      <li>Group, Location, Media are boolean flags for filtering</li>
      <li>State is an internal field for editor notes</li>
      <li>Published is a flag marking entries which should be shown publicly</li>
    </ul>
    <a class="w3-button w3-green none" href="{{url_for('organize_new')}}">Create New Structure</a>
  </div>
</div>

{% for contact in contacts %}
<div class="w3-row contact">
  <h3 class="contact-title">{{contact.texts['en'].name}}</h3>
  <div class="organize">
    {% for lang in languages %}
    <div class="w3-third">
      <h4>{{lang}}</h4>
      <p><b>Name:</b> {{contact.texts[lang].name}}</p>
      <p><b>Short Description:</b> {{contact.texts[lang].short_description}}</p>
      <p><b>Description:</b> {{contact.texts[lang].description | replace('\n', '<br/>' | safe)}}</p>
      <p><b>Resources:</b> {{contact.texts[lang].resources | replace('\n', '<br/>' | safe)}}</p>
      <p><b>Base Address:</b> {{contact.texts[lang].base_address}}</p>
      <p><b>Addresses:</b> {{contact.texts[lang].addresses | urlize(target='_blank') | replace('\n', '<br/>' | safe)}}</p>
      <p><b>Contact:</b> {{contact.texts[lang].contact | urlize(target='_blank') | replace('\n', '<br/>' | safe)}}</p>
    </div>
    {% endfor %}
    <div class="w3-third full-last">
      <p><b>Latitude, Longitude:</b> {{contact.geo_coord}}</p>
      <p><b>Image:</b> {{contact.image}}</p>
      <p><b>Email:</b> {{contact.email}}</p>
      <p><b>Group:</b> {{contact.is_group}}</p>
      <p><b>Location:</b> {{contact.is_location}}</p>
      <p><b>Media:</b> {{contact.is_media}}</p>
      <p><b>State</b>: {{contact.state}}</p>
      <p><b>Published:</b> {{contact.published}}</p>
      <p><a class="w3-button w3-black none" href="{{url_for('organize_edit', id=contact.id)}}">Edit</a></p>
      <p><a class="w3-button w3-red none" href="{{url_for('organize_contact', id=contact.id)}}">Delete</a></p>
    </div>
  </div>
</div>
{% endfor %}
{% endblock %}
