{% from 'organize_macros.html' import organize_hints %}
{% extends 'base.html' %}

{% block content %}
<h1>Organize</h1>
<div class="w3-row controls">
  <form class="controls-form" action="{{url_for('organize')}}">
    <div class="control-item">
      <label for="group">{{L['list']['group_filter']}}:&nbsp;</label>
      <input
          id="group" class="w3-input" type="checkbox" name="group"
          {% if request.args.get('group') %}checked{% endif %}
      />
    </div>
    <div class="control-item">
      <label for="location">{{L['list']['location_filter']}}:&nbsp;</label>
      <input
          id="location" class="w3-input" type="checkbox" name="location"
          {% if request.args.get('location') %}checked{% endif %}
      />
    </div>
    <div class="control-item">
      <label for="media">{{L['list']['media_filter']}}:&nbsp;</label>
      <input
          id="media" class="w3-input" type="checkbox" name="media"
          {% if request.args.get('media') %}checked{% endif %}
      />
    </div>
    <div class="control-item">
      <input
          id="query" class="w3-input" type="text" placeholder="{{L['list']['search_query_filter']}}" name="query"
          value="{{request.args.get('query') or ''}}"
      />
    </div>
    <button class="w3-button w3-black" type="submit">{{L['list']['search_button']}}</button>
  </form>
  <a class="w3-button w3-black none" href="{{url_for('organize')}}">{{L['list']['reset_search_button']}}</a>
  <div class="control-item count"><span>{{contacts|length}} {{L['list']['num_structures_label']}}</span></div>
  <br/>
  <div>
    {{organize_hints()}}
    <a class="w3-button w3-green none" href="{{url_for('organize_new')}}">Create New Entry</a>
  </div>
</div>

{% for contact in contacts %}
<div class="w3-row contact">
  <h3 class="contact-title">{{contact.texts['en'].name}}</h3>
  <div class="organize">
    {% for lang in languages %}
    <div class="w3-third">
      <h4>{{lang}}</h4>
      <p><b>Name:</b> {{contact.texts[lang].name}}</p>
      <p><b>Short Description:</b> {{contact.texts[lang].short_description}}</p>
      <p><b>Description:</b> {{contact.texts[lang].description | replace('\n', '<br/>' | safe)}}</p>
      <p><b>Resources:</b> {{contact.texts[lang].resources | replace('\n', '<br/>' | safe)}}</p>
      <p><b>Base Address:</b> {{contact.texts[lang].base_address}}</p>
      <p><b>Addresses:</b> {{contact.texts[lang].addresses | urlize(target='_blank') | replace('\n', '<br/>' | safe)}}</p>
      <p><b>Contact:</b> {{contact.texts[lang].contact | urlize(target='_blank') | replace('\n', '<br/>' | safe)}}</p>
    </div>
    {% endfor %}
    <div class="w3-third full-last">
      <p><b>Latitude, Longitude:</b> {{contact.geo_coord}}</p>
      <p><b>Image:</b> {{contact.image}}</p>
      <p><b>Email:</b> {{contact.email}}</p>
      <p><b>Group:</b> {{contact.is_group}}</p>
      <p><b>Location:</b> {{contact.is_location}}</p>
      <p><b>Media:</b> {{contact.is_media}}</p>
      <p><b>State:</b> {{contact.state}}</p>
      <p><b>Published:</b> {{contact.published}}</p>
      <p><a class="w3-button w3-black none" href="{{url_for('organize_edit', id=contact.id)}}">Edit</a></p>
      <p><a class="w3-button w3-red none" href="{{url_for('organize_contact', id=contact.id)}}">Delete</a></p>
    </div>
  </div>
</div>
{% endfor %}
{% endblock %}
